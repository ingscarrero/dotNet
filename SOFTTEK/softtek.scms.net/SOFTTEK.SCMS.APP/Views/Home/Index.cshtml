<header>
    @*<div class="content-wrapper">
            <div class="float-left">
                <center>
                    <p class="site-title">
                        <a href="~/">SOFTTEK CORPORATE MOBILE SOLUTIONS</a>
                    </p>
                </center>
            </div>
        </div>*@

    <script src="~/Scripts/CryptoJS%20v3.1.2/components/core-min.js"></script>
    <script src="~/Scripts/CryptoJS%20v3.1.2/components/enc-base64-min.js"></script>
    <script src="~/Scripts/CryptoJS%20v3.1.2/rollups/sha256.js"></script>
    <script src="~/Scripts/CryptoJS%20v3.1.2/rollups/pbkdf2.js"></script>
    <script src="~/Scripts/CryptoJS%20v3.1.2/rollups/aes.js"></script>
    <script src="~/Scripts/SCMSWeb/Security.js"></script>
    <script src="~/Scripts/SCMSWeb/App.js"></script>
    @*<script src="~/Scripts/jquery-2.1.4.js" type="text/javascript"></script>*@
    @*<script src="~/Scripts/jquery.min.js"></script>*@
    @*<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>*@
    <script src="~/Scripts/jquery-1.7.2.js"></script>
    <script src="~/Scripts/semantic.js"></script>
    <link href="~/Content/components/accordion.css" rel="stylesheet" />
    <script src="~/Content/components/accordion.js"></script>
    <link href="~/Content/semantic.css" rel="stylesheet" />
    <link href="~/Content/StyleResponsive.css" rel="stylesheet" />
    <link href="~/Content/jquery-ui.css" rel="stylesheet" />
    <link href="~/Content/components/menu.css" rel="stylesheet" />
    
</header>
<div id="body" class="divBody">
    <div class="ui raised segment signin fondoTransparente divLogin" id="divLogin">
        <div id="user">
            <img src="~/Images/circle.png" id="circle_1" hspace="16" vspace="16" />
            <img src="~/Images/anonymous.png" id="circle_2" />
        </div>

        <div class="ui column grid basic segment" style="margin-top:10%!important;">
            <div class="column">
                <div class="ui black stacked segment backBlue">
                    <!-- form here -->
                    <input type="hidden" name="Token" value="" id="token" />
                    <form id="authentication" method="post" class="ui form">
                        <input type="hidden" name="DeviceIdentifier" value="DELL-09182098321" />
                        <div class="three fields">
                            <div class="field vertical-centered-text_rigth">
                                Network Account:
                            </div>
                            <div class="field min_size">
                                <div class="ui right labeled icon input">
                                    <input type="text" name="NetworkAccount">
                                    <i class="user icon"></i>
                                </div>
                            </div>
                            <div class="field min_size vertical-centered-text_left">
                                @@Softtek.com
                            </div>
                        </div>
                        <div class="three fields">
                            <div class="field vertical-centered-text_rigth">
                                Password:
                            </div>
                            <div class="ten wide field">
                                <div class="ui right labeled icon input">
                                    <input type="password" name="Password">
                                    <i class="lock icon"></i>
                                </div>
                            </div>
                        </div>
                        @*<div class="inline field">
                                <div class="ui checkbox">
                                    <input id="remember" type="checkbox">
                                    <label for="remember"> Recordar </label>
                                </div>
                            </div>*@
                        <center><input type="button" id="login_button" value="Login" class="ui circular negative button space_Content" /></center>
                    </form>
                    <div class="ui icon message" id="menssageError">
                        <i class="notched circle loading icon"></i>
                        <div class="content">
                            <div class="header">
                                Por favor complete los datos necesarios para iniciar sesión.
                            </div>
                            <p>Alerta.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @*<div id="divMenuItems" class="menuResponsive clearfix">
            <div id="divHeadMenu" class="menuHead imgTranspartentMore">
                <img src="~/Images/menu_encabezado.png" class="ui fluid image imgHead" />
            </div>

            <div id="dicContentMenu" class="contentMenu">
                <div class="imgTranspartent" style="margin-top:30%;">
                    <img class="resImage" src="~/Images/barPrin.jpg" />
                </div>

                <div class="imgTranspartent">
                    <img class="resImage" src="~/Images/digital_softwareproduct.jpg" />
                </div>
                <div class="imgTranspartent">
                    <img class="resImage" src="~/Images/barPrin.jpg" />
                </div>
                <div class="imgTranspartent">
                    <img class="resImage" src="~/Images/digital_softwareproduct.jpg" />
                </div>
            </div>
            <div id="divFootMenu" class="menuFoot">
                <img src="~/Images/menu_pie.png" class="ui fluid image" />
            </div>
        </div>*@

    <div id="divContent" style="position:relative !important">

        @*<div>
                <ul id="menu_items"></ul>
                <p id="employee">
                </p>
                <input type="button" id="refresh_btn" value="Refresh" class="negative ui button"/>
            </div>*@
        <div class="field" style="display:inline-block; z-index: 2 !important;">
            <input type="hidden" name="EmployeeID" value="" id="employee_id" />
            <button class="ui black big launch  button btnMenu" id="btnMenu" >
                <i class="content icon"></i>
            </button>
        </div>
        <div class="ui menuFlotante" id="divMenu" style="float: left !important;">
            <div class="field" style="display:inline-block; z-index: 10 !important; margin-bottom:5%;" id="divBtnMenu2">
                <button class="ui black big launch  button btnMenu" id="btnMenu2">
                    <i class="content icon"></i>
                </button>
            </div>
            <div class="field">
                <p id="employee">
            </div>
            <div class="field center">
                <center><input type="button" id="refresh_btn" value="Refresh" class="negative ui button" /></center>
            </div>
            <br />
            <hr />
            <div class="field">
                <ul id="menu_items"></ul>
            </div>
        </div>

        <div class="ui accordion divContent" id="divAccordion" style="clear: left !important;">
            <div class="title">
                <i class="dropdown icon"></i>
                Cambiar Imagen de perfil
            </div>
            <div class="content contentAccordion" style="height:auto !important;  display: block !important; width:100% !important;">
                <form id="image_upload" enctype="multipart/form-data" class="ui form">
                    <fieldset>
                        <legend><strong>Actualizar imagen de perfil</strong></legend>
                        <br />
                        <div class="field">
                            <label for="EmployeePicture">Image File</label>
                            <input name="EmployeePicture" id="image_to_upload" type="file" />
                        </div>
                        <div class="field">
                            <br />
                            <input type="button" id="upload_button" value="Subir Imagen" class="positive ui button" />
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="title">
                <i class="dropdown icon"></i>
                Insertar una actividad
            </div>
            <div class="content contentAccordion" style="height:auto !important;">
                <form id="activity" method="post" class="ui form">
                    <fieldset>
                        <legend><strong>Registrar actividad</strong></legend>
                        <div class="field">
                            <label for="Jornade">Jornada</label>
                            <select name="Jornade" id="activity_jornade" form="activity" class="ui selection dropdown"></select>
                        </div>
                        <div class="field">
                            <label for="Project">Proyecto</label>
                            <input name="Project" id="activity_project" type="text" />
                        </div>
                        <div class="field">
                            <label for="ActivityCode">Código de Actividad</label>
                            <select name="ActivityCode" id="activity_code" form="activity" class="ui selection dropdown"></select>
                        </div>
                        <div class="field">
                            <label for="Requirement">Requerimiento</label>
                            <input name="Requirement" id="activity_requitement" type="text" />
                        </div>
                        <div class="field">
                            <label for="Stage">Etapa</label>
                            <select name="Stage" id="activity_stage" form="activity" class="ui selection dropdown"></select>
                        </div>
                        <div class="field">
                            <label for="DevelopmentActivity">Actividad de Desarrollo</label>
                            <select name="DevelopmentActivity" id="activity_development_activity" form="activity" class="ui selection dropdown"></select>
                        </div>
                        <div class="field">
                            <label for="Details">Detalle</label>
                            <input name="Details" id="activity_details" type="text" />
                        </div>
                        <div class="field">
                            <label for="">ExecutedAt</label>
                            <input name="ExecutedAt" id="activity_executed_at" type="date" />
                        </div>
                        <div class="field">
                            <label for="">Effort</label>
                            <input name="Effort" id="activity_effort" type="number" />
                        </div>

                        <div class="field">
                            <br />
                            <input type="button" id="submit_button" value="Guardar" class="positive ui button" />
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="title">
                <i class="dropdown icon"></i>
                Buscaqueda por usuario de Permisos y ausencias
            </div>
            <div class="content contentAccordion" style="height:auto !important;">
                <form class="ui form" id="searchPermitsAndAbsences" method="post">
                    <fieldset>
                        <legend>Busqueda de Permisos y ausencias por usuario</legend>
                    </fieldset>
                    <br />
                    <div class="field">
                        <label for="idEmployee">Id del usuario</label>
                        <input type="number" id="idEmployee" name="idEmployee" />
                    </div>
                    <div class="field">
                        <input type="button" id="btnSearchPermitsAndAbsences" value="Realizar Busqueda" class="positive ui button" />
                    </div>
                    <br />
                    <div id="divTableResult"></div>
                </form>
            </div>
            <div class="title">
                <i class="dropdown icon"></i>
                Insertar Permiso o ausencia
            </div>
            <div class="content contentAccordion" style="height:auto !important;">
                <form id="permisosyAusencias" method="post" class="ui form">
                    <fieldset>
                        <legend><strong>Registrar ausencias y permisos</strong></legend>
                        <div class="field">
                            <label for="perabs_activity_code">Actividad de Desarrollo</label>
                            <select name="perabs_activity_code" id="perabs_activity_code" form="permisosyAusencias" class="ui selection dropdown"></select>
                        </div>

                        <div class="field">
                            <label for="perabs_start_at">Start At</label>
                            <input type="date" name="perabs_start_at" id="perabs_start_at" />
                        </div>
                        <div class="field">
                            <label for="perabs_end_at">End At</label>
                            <input type="date" name="perabs_end_at" id="perabs_end_at" />
                        </div>
                        <div class="field">
                            <label for="perabs_total_hours">Total Hours</label>
                            <input type="number" name="perabs_total_hours" id="perabs_total_hours" />
                        </div>
                        <div class="field">
                            <label for="perabs_validated_by">Validated for</label>
                            <input type="text" name="perabs_validated_by" id="perabs_validated_by" />
                        </div>
                        <div class="field">
                            <label for="perabs_description">Description</label>
                            <input id="perabs_description" name="perabs_description" />
                        </div>
                        <div class="field">
                            <label for="perabs_validated_comments">Coments valid</label>
                            <input id="perabs_validated_comments" name="perabs_validated_comments" />
                        </div>
                        <div class="field">
                            <input id="perabs_employee" name="perabs_employee" type="hidden" />
                        </div>
                        <div class="field">
                            <label for="perabs_Status">Status</label>
                            <select name="perabs_Status" id="perabs_Status" form="permisosyAusencias" class="ui selection dropdown"></select>
                        </div>
                        <div class="field">
                            <br />
                            <input value="SICR2" name="perabs_created_by" id="perabs_created_by" type="hidden" />
                        </div>

                        <div class="field">
                            <input type="button" id="submit_button_Ab" value="Guardar Ausencia" class="positive ui button" />
                        </div>

                    </fieldset>
                </form>
            </div>
        </div>
        @*<img class='rotateMe' src='https://www.dropbox.com/static/images/publinks.png' />*@
    </div>
</div>

@section scripts{
    @*<script src="//code.jquery.com/jquery-1.10.2.js"></script>
        <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>*@
    <script src="~/Scripts/jquery-ui.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            $('#divContent').hide();
            $('#menssageError').hide();
            $('#divAccordion').accordion();
            $('#divMenu').hide();
            //$('#divMenuItems').hide();
        });

        function progressHandlingFunction(e) {
            if (e.lengthComputable) {
                $('#up_img_pgrs').attr({ value: e.loaded, max: e.total });
            }
        }

        $("#btnMenu").click(function () {
            $("#btnMenu").each(function () {
                displaying = $('#divMenu').css("display");
                if (displaying == "block") {
                    $('#divMenu').fadeOut('slow', function () {
                        $(this).css("display", "none");
                    });
                } else {
                    $('#divMenu').fadeIn('slow', function () {
                        $(this).css("display", "block");
                    });
                }
            });
        });

        $("#btnMenu2").click(function () {
            $("#btnMenu2").each(function () {
                displaying = $('#divMenu').css("display");
                if (displaying == "block") {
                    $('#divMenu').fadeOut('slow', function () {
                        $(this).css("display", "none");
                    });
                } else {
                    $('#divMenu').fadeIn('slow', function () {
                        $(this).css("display", "block");
                    });
                }
            });
        });

        $(document).ready(function () {
            AppSCMS.init();
            var app = 'core';

            $('#login_button').click(function () {

                var authentication = AppSCMS.parseToObject('#authentication');

                var NetworkAccount = authentication.NetworkAccount;
                var Password = authentication.Password;
                if ((NetworkAccount = null || NetworkAccount == "" || typeof (NetworkAccount) === "undefined") || (Password = null || Password == "" || typeof (Password) === "undefined")) {
                    $('#menssageError').show();
                }
                else {

                    var credentials = AppSCMS.parseToSecureObject('#authentication');
                    //$('#divMenuItems').show();
                    $('#divContent').show();
                    SecuritySCMS.authenticate(app, credentials, function (data) {
                        $('#token').val(data.Identifier);

                        AppSCMS.deviceID.set(SecuritySCMS.encrypt('DELL-09182098321'));
                        AppSCMS.token.set($('#token').val());
                        AppSCMS.app.set(app);


                        AppSCMS.retrieveParameter('SRA_SOFTTEK_PROJECT_ACTIVITIES', function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Value).text(item.Description);
                                    $('#activity_code').append(option);
                                }
                            });
                        }, null);

                        AppSCMS.retrieveParameter('SRA_SOFTTEK_PNOCH_ACTIVITIES', function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Value).text(item.Description);
                                    $('#activity_code').append(option);
                                }
                            });
                        }, null);

                        //AppSCMS.SearchPermitsAndAbsencesForUser('6', function (data) {
                        //    $(data).each(function (i, item) {
                        //        //if (item) {
                        //        //    var option = $('<option></option>').attr('value', item.Value).text(item.Description);
                        //        //    $('#activity_code').append(option);
                        //        //}
                        //    });
                        //}, null);

                        //AppSCMS.SearchActividadesUser('3', function (data) {
                        //    $(data).each(function (i, item) {
                        //        //if (item) {
                        //        //    var option = $('<option></option>').attr('value', item.Value).text(item.Description);
                        //        //    $('#activity_code').append(option);
                        //        //}
                        //    });
                        //}, null);

                        AppSCMS.retrieveParameter('ARS_SOFTTEK_DEV_STAGES', function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Value).text(item.Description);

                                    $('#activity_stage').append(option);
                                }
                            });
                        }, null);

                        AppSCMS.retrieveParameter('SRA_PERMITS_AND_ABSENCES', function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Identifier).text(item.Description);

                                    $('#perabs_activity_code').append(option);
                                }
                            });
                        }, null);

                        AppSCMS.retrieveParameter('SRA_STATUS_PERMITS_AND_ABSENCES', function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Value).text(item.Description);

                                    $('#perabs_Status').append(option);
                                }
                            });
                        }, null);

                        AppSCMS.retrieveParameter('ARS_SOFTTEK_DEV_ACT', function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Value).text(item.Description);
                                    $('#activity_development_activity').append(option);
                                }
                            });
                        }, null);

                        AppSCMS.retrieveParameter('SRA_JORNADE_TYPE', function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Value).text(item.Description);
                                    $('#activity_jornade').append(option);
                                }
                            });
                        }, null);
                        // Retrieve SAP Master Data
                        AppSCMS.retrieveSAPPMMasterData(function (data) {
                            $(data).each(function (i, item) {
                                if (item) {
                                    var option = $('<option></option>').attr('value', item.Value).text(item.Description);
                                    $('#sap_master_data').append(option);
                                }
                            });
                        }, null);

                        AppSCMS.retrieveAppMenu(function (data) {
                            $(data).each(function (i, item) {
                                $('#menu_items').append('<li><a href="">' + item.Title + '</a></li>');
                            });
                        }, null);

                        AppSCMS.retrieveEmployeeInformationForToken(function (data) {
                            var employeeID = data.Identifier;
                            $('#employee').append('<p><b>Información del empleado:</b></p>');
                            $('#employee').append('<br/>');
                            $('#employee').append('<img class="picture imageCenter" src="#" alt="' + data.Person.FullName + '" style="width:100px; height:100px; border-radius:50px;" /><br/>');
                            $('#employee').append('<p>');
                            $('#employee').append('<b>Nombre:</b> ' + data.Person.FullName);
                            $('#employee').append('<br/>');
                            $('#employee').append('<b>Area:</b> ' + data.Area);
                            $('#employee').append('<br/>');
                            $('#employee').append('<b>Rol:</b> ' + data.Role);
                            $('#employee').append('<br/>');
                            $('#employee').append('<b>Superior Inmediato:</b> ' + data.Supervisor.Person.FullName);
                            $('#employee').append('</p>');
                            $('#employee').append('<br/>');
                            $('#employee_id').val(employeeID);

                            AppSCMS.retrieveEmployeeImageForEmployeeId(employeeID, function (data) {
                                $('.picture').attr('src', 'data:image/png;base64,' + data);
                            }, null);

                            AppSCMS.retriveSRAWeekInformation(employeeID, function (data) {
                                console.log(data);
                            }, null);
                        }, null);
                    });
                    $('#divLogin').hide();
                }
            });

            $('#submit_button').click(function () {
                AppSCMS.deviceID.set(SecuritySCMS.encrypt('DELL-09182098321'));
                AppSCMS.token.set($('#token').val());
                AppSCMS.app.set(app);

                var activity = AppSCMS.parseToObject('#activity');
                activity.Employee = { "Identifier": $('#employee_id').val() };

                AppSCMS.registerActivity(activity, function (data) {
                }, function (data) {
                });
            });

            $('#submit_button_Ab').click(function () {
                AppSCMS.deviceID.set(SecuritySCMS.encrypt('DELL-09182098321'));
                AppSCMS.token.set($('#token').val());
                AppSCMS.app.set(app);

                var activity = AppSCMS.parseToObject('#permisosyAusencias');
                activity.perabs_employee = { "Identifier": $('#employee_id').val() };

                AppSCMS.registerPermitsAndAbsences(activity, function (data) {
                }, function (data) {
                });
            })

            $('#upload_button').click(function () {
                AppSCMS.deviceID.set(SecuritySCMS.encrypt('DELL-09182098321'));
                AppSCMS.token.set($('#token').val());
                AppSCMS.app.set(app);

                $('#image_upload').append('<progress id="up_img_pgrs"></progress>');

                var employeeID = $('#employee_id').val();
                var image = new FormData($('#image_upload')[0]);

                AppSCMS.setEmployeeImageForEmployeeId(employeeID, image, function () {
                    // Custom XMLHttpRequest
                    var myXhr = $.ajaxSettings.xhr();
                    if (myXhr.upload) { // Check if upload property exists
                        myXhr.upload.addEventListener('progress', progressHandlingFunction, false); // For handling the progress of the upload
                    }
                    return myXhr;
                }, function () {
                    $('#up_img_pgrs').remove();
                }, null);
            });

            $('#btnSearchPermitsAndAbsences').click(function () {
                AppSCMS.deviceID.set(SecuritySCMS.encrypt('DELL-09182098321'));
                AppSCMS.token.set($('#token').val());
                AppSCMS.app.set(app);

                var searchPermitsAndAbsences = AppSCMS.parseToObject('#searchPermitsAndAbsences');
                AppSCMS.SearchPermitsAndAbsencesForUser(searchPermitsAndAbsences.idEmployee, function (data) {
                    if (data != null || typeof (data) != "undefined" || data != "") {
                        $('#divTableResult').append('<table>');
                        $('#divTableResult').append('<tr><th>Employee_id<th></tr>');
                        $(data).each(function (i, item) {

                            $('#divTableResult').append('<tr>');
                            $('#divTableResult').append('<td>' + data.perabs_employee.Identifier + "</td>");
                            $('#divTableResult').append('</tr>');
                        });
                        $('#divTableResult').append('</table>');
                    }
                }, null);
            })
        });
    </script>
}